<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<title>ENTRETALLES – NIÑOS</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<style>
:root{ --azul-top:#1e4aa3; --azul-bottom:#315ec9; --rosa:#ff1493; --txt:#ffffff; --azul-btn:#0b2f6b; --azul-footer:#0d3385; }
*{box-sizing:border-box} body{margin:0;font-family:Arial,Helvetica,sans-serif;background:#fff;color:#113}
header{background:linear-gradient(180deg,var(--azul-top),var(--azul-bottom));color:var(--txt);padding:24px 16px 28px}
.header-wrap{max-width:1080px;margin:0 auto;display:grid;grid-template-columns:180px 1fr 140px;gap:16px;align-items:center}
.logo{width:150px;height:auto;border-radius:10px;background:#fff;padding:18px;box-shadow:0 3px 10px rgba(0,0,0,.25)}
.brand{text-align:center}.brand h1{margin:0 0 6px;font-size:36px}.brand p{margin:0;opacity:.95}
.header-actions{display:flex;justify-content:flex-end;align-items:center;gap:10px}
.profile-btn{display:inline-flex;align-items:center;gap:8px;background:#ffffff20;color:#fff;border:1px solid #ffffff40;border-radius:999px;padding:8px 12px;cursor:pointer;text-decoration:none;font-weight:bold}
.profile-btn:hover{background:#ffffff30}
nav{background:var(--rosa);display:flex;justify-content:center;gap:28px;padding:10px 12px;font-weight:bold;position:relative}
nav a{color:#fff;text-decoration:none;padding:8px 14px;border-radius:999px}
nav a:hover{background:rgba(255,255,255,.18)}
#cart-count{display:none; position:absolute; top:-6px; right:-10px; background:#fff; color:#d6006e; border-radius:999px; padding:2px 6px; font-size:12px; font-weight:bold}
.search{max-width:1200px;margin:16px auto 0;padding:0 16px;text-align:center}
.search input{width:300px;padding:10px;border:1px solid #ccc;border-radius:8px;font-size:16px}
.carousel-shell{max-width:1400px;margin:18px auto 56px;position:relative}
.track{display:flex;gap:24px;overflow-x:auto;scroll-behavior:smooth;padding:6px 16px}
.track::-webkit-scrollbar{display:none}
.card{flex:0 0 auto;width:340px;background:#f6f7fb;border-radius:14px;padding:16px;text-align:center;box-shadow:0 8px 24px rgba(0,0,0,.12)}
.card img{width:100%;height:360px;object-fit:contain;background:#fff;border-radius:10px;cursor:pointer}
.card h3{margin:12px 0 6px;color:#113a7a;text-transform:uppercase;font-size:17px}
.price{font-weight:bold;margin:4px 0}
.actions{display:flex;gap:8px;justify-content:center;margin-top:8px;flex-wrap:wrap}
.btn{display:inline-block;background:var(--azul-btn);color:#fff;padding:10px 16px;border-radius:9px;text-decoration:none;font-weight:bold;border:0;cursor:pointer}
.arrow{position:fixed;top:50%;transform:translateY(-50%);font-size:36px;background:#fff;color:#315ec9;border-radius:50%;padding:8px 12px;cursor:pointer;box-shadow:0 3px 10px rgba(0,0,0,.3);z-index:1000;user-select:none}
.arrow:hover{background:#e6f7ff}.arrow-left{left:8px}.arrow-right{right:8px}
#lightbox{display:none;position:fixed;inset:0;background:rgba(0,0,0,.85);justify-content:center;align-items:center;z-index:1200}
#lightbox img{max-width:92%;max-height:92%} #lightbox:target{display:flex}
footer{background:var(--azul-footer);color:#fff;text-align:center;padding:22px 16px}
.social img{width:28px;margin:0 8px;vertical-align:middle}

/* Modal comprador (opcional) */
.modal-backdrop{display:none;position:fixed;inset:0;background:rgba(0,0,0,.55);z-index:2000;align-items:center;justify-content:center;padding:16px}
.modal{width:100%;max-width:520px;background:#fff;border-radius:14px;box-shadow:0 12px 34px rgba(0,0,0,.25);overflow:hidden}
.modal header{background:linear-gradient(180deg,var(--azul-top),var(--azul-bottom));color:#fff;padding:14px 16px}
.modal .content{padding:16px}
.form-row{display:flex;flex-direction:column;gap:6px;margin-bottom:12px}
.input{padding:10px;border:1px solid #cfd6ff;border-radius:8px;font-size:15px}
.form-actions{display:flex;gap:10px;justify-content:flex-end;margin-top:10px}
.note{font-size:12px;color:#456}
.req{color:#d6006e}

@media (max-width:640px){ .logo{width:140px} .brand h1{font-size:28px} .card{width:300px} .card img{height:320px} }
</style>
</head>
<body>
<header>
  <div class="header-wrap">
    <img class="logo" src="https://i.postimg.cc/852rV0T7/Whats-App-Image-2025-03-26-at-12-46-00.jpg" alt="Logo">
    <div class="brand"><h1>ENTRETALLES</h1><p>Moldería Digital – NIÑOS</p></div>
    <div class="header-actions">
      <button class="profile-btn" id="openProfile" title="Mis datos">
        <svg width="18" height="18" viewBox="0 0 24 24" fill="none" aria-hidden="true">
          <path d="M12 12c2.9 0 5-2.1 5-5s-2.1-5-5-5-5 2.1-5 5 2.1 5 5 5Zm0 2c-4 0-8 2-8 6v2h16v-2c0-4-4-6-8-6Z" fill="white"/>
        </svg>
        <span>Mi cuenta</span>
      </button>
    </div>
  </div>
</header>

<nav>
  <a href="index.html">Inicio</a>
  <a href="digital.html">Digital</a>
  <a href="cart.html" style="position:relative">🛒 Carrito <span id="cart-count">0</span></a>
</nav>

<div class="search"><input id="q" type="text" placeholder="Buscar prenda..."></div>

<span class="arrow arrow-left" onclick="scrollTrack(-1)">&#10094;</span>
<span class="arrow arrow-right" onclick="scrollTrack(1)">&#10095;</span>

<section class="carousel-shell">
  <div id="track" class="track"></div>
</section>

<div id="lightbox" onclick="closeLightbox(event)"><img id="zoom" alt="Vista previa" /></div>

<footer>
  <p>© 2025 Entretalles. Todos los derechos reservados.</p>
  <div class="social">
    <a href="https://www.instagram.com/mgconfecciones.arg/" target="_blank"><img src="https://upload.wikimedia.org/wikipedia/commons/a/a5/Instagram_icon.png" alt="Instagram"></a>
    <a href="https://wa.me/541133627786" target="_blank"><img src="https://upload.wikimedia.org/wikipedia/commons/6/6b/WhatsApp.svg" alt="WhatsApp"></a>
    <a href="https://www.facebook.com/share/17EgVid4V9/?mibextid=wwXIfr" target="_blank"><img src="https://upload.wikimedia.org/wikipedia/commons/1/1b/Facebook_icon.svg" alt="Facebook"></a>
  </div>
</footer>

<script src="cart.js"></script>
<script>
const CATEGORIA="Niños";
const SHEET_URL='https://docs.google.com/spreadsheets/d/e/2PACX-1vT2pGJPY3fyOiaSeicE7bKk3TqW4uKZaZeznY_mX31fNzgXpjcxUivyuHoMDTZNjrTSnNbTknRZ966y/pub?gid=0&single=true&output=csv';
const MP_LINK='https://mpago.la/14ApgVg';
const norm = s => (s||'').normalize('NFD').replace(/[\u0300-\u036f]/g,'').toLowerCase();
let items=[];
fetch(SHEET_URL).then(r=>r.text()).then(csv=>{
  const rows=csv.trim().split('\n').map(r=>r.split(','));
  const headers=rows.shift().map(h=>h.trim().toLowerCase());
  rows.forEach(row=>{
    const o={}; headers.forEach((h,i)=>o[h]=(row[i]||'').trim());
    const cat=norm(o.categoria);
    if(cat==='ninos' || cat==='ninios') items.push(o);
  });
  render(items);
  document.getElementById('q').addEventListener('input',e=>{
    const q=e.target.value.toLowerCase();
    render(items.filter(x=>(x.nombre||'').toLowerCase().includes(q)||(x.descripcion||'').toLowerCase().includes(q)));
  });
}).catch(console.error);

function render(arr){
  const el=document.getElementById('track'); el.innerHTML='';
  arr.forEach(x=>{
    el.insertAdjacentHTML('beforeend', `
      <div class="card">
        <img src="${x.imagen||''}" alt="${x.nombre||''}" onclick="openLightbox('${(x.imagen||'').replace(/'/g,"\\'")}')">
        <h3>${x.nombre||''}</h3>
        <div class="price">$${x.precio||''}</div>
        <p>${x.descripcion||''}</p>
        <div class="actions">
          <a class="btn" href="${MP_LINK}" target="_blank">Comprar</a>
          <button class="btn" onclick='addToCart({
            categoria:${JSON.stringify(CATEGORIA)},
            nombre:${JSON.stringify(x.nombre||"")},
            precio:${JSON.stringify(x.precio||"")},
            imagen:${JSON.stringify(x.imagen||"")}
          })'>Agregar al carrito</button>
        </div>
      </div>
    `);
  });
  EntretallesCart.updateBadge();
}
function scrollTrack(dir){ document.getElementById('track').scrollBy({left:dir*360,behavior:'smooth'}); }
function openLightbox(src){ document.getElementById('zoom').src=src; location.hash='lightbox'; }
function closeLightbox(e){ if(e.target.id==='lightbox'){ location.hash=''; } }
function addToCart(it){
  if(!window.EntretallesCart){ alert("No se cargó el carrito (cart.js)."); return; }
  EntretallesCart.add(it);
  try{ const btn=event?.currentTarget; if(btn){ const old=btn.textContent; btn.textContent="¡Agregado!"; setTimeout(()=>btn.textContent=old,900);} }catch(e){}
}

/* Modal “Mi cuenta” (opcional) */
const buyerModal = document.getElementById('buyerModal');
const openProfile = document.getElementById('openProfile');
const cancelBuyer = document.getElementById('cancelBuyer');
const saveBuyer = document.getElementById('saveBuyer');
const nameInput = document.getElementById('buyerName');
const phoneInput = document.getElementById('buyerPhone');
const emailInput = document.getElementById('buyerEmail');

function loadBuyer(){
  try{
    const data = JSON.parse(localStorage.getItem('entretalles_buyer')||'{}');
    nameInput.value  = data.name  || '';
    phoneInput.value = data.phone || '';
    emailInput.value = data.email || '';
  }catch(e){}
}
function showBuyerModal(){ loadBuyer(); buyerModal.style.display='flex'; }
function hideBuyerModal(){ buyerModal.style.display='none'; }

openProfile?.addEventListener('click', showBuyerModal);
cancelBuyer?.addEventListener('click', hideBuyerModal);
buyerModal?.addEventListener('click', e=>{ if(e.target===buyerModal) hideBuyerModal(); });

function validateBuyerOptional(){
  const name = nameInput.value.trim();
  const phone = phoneInput.value.trim();
  const email = emailInput.value.trim();
  if(!name && !phone && !email) return {};
  const emailOk = !email || /^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(email);
  if(email && !emailOk){ alert('Email inválido'); return null; }
  return { name, phone, email };
}
saveBuyer?.addEventListener('click', ()=>{
  const data = validateBuyerOptional(); if(data===null) return;
  localStorage.setItem('entretalles_buyer', JSON.stringify(data));
  hideBuyerModal();
  try{ const btn=openProfile; const old=btn.textContent; btn.textContent="¡Guardado!"; setTimeout(()=>btn.textContent="Mi cuenta",900);}catch(e){}
});
</script>

<!-- MODAL -->
<div class="modal-backdrop" id="buyerModal">
  <div class="modal" role="dialog" aria-modal="true" aria-labelledby="buyerTitle">
    <header><h3 id="buyerTitle" style="margin:0">Datos del comprador</h3></header>
    <div class="content">
      <div class="form-row">
        <label>Nombre y apellido</label>
        <input class="input" id="buyerName" type="text" placeholder="tu nombre">
      </div>
      <div class="form-row">
        <label>Teléfono</label>
        <input class="input" id="buyerPhone" type="tel" placeholder="12345678">
      </div>
      <div class="form-row">
        <label>Email</label>
        <input class="input" id="buyerEmail" type="email" placeholder="cliente@mail.com">
      </div>
      <div class="note">Podés guardar tus datos para agilizar la compra en el carrito.</div>
      <div class="form-actions">
        <button class="btn light" id="cancelBuyer">Cerrar</button>
        <button class="btn" id="saveBuyer">Guardar</button>
      </div>
    </div>
  </div>
</div>
</body>
</html>
