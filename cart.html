<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<title>ENTRETALLES â€“ CARRITO</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<style>
:root{ --azul-top:#1e4aa3; --azul-bottom:#315ec9; --rosa:#ff1493; --txt:#ffffff; --azul-btn:#0b2f6b; --azul-footer:#0d3385; }
*{box-sizing:border-box}
body{margin:0;font-family:Arial,Helvetica,sans-serif;background:#fff;color:#113}
header{background:linear-gradient(180deg,var(--azul-top),var(--azul-bottom));color:var(--txt);padding:24px 16px 28px}
.header-wrap{max-width:1080px;margin:0 auto;display:grid;grid-template-columns:180px 1fr;gap:16px;align-items:center}
.logo{width:150px;height:auto;border-radius:10px;background:#fff;padding:18px;box-shadow:0 3px 10px rgba(0,0,0,.25)}
.brand{text-align:center}.brand h1{margin:0 0 6px;font-size:36px}.brand p{margin:0;opacity:.95}
nav{background:var(--rosa);display:flex;justify-content:center;gap:28px;padding:10px 12px;font-weight:bold}
nav a{color:#fff;text-decoration:none;padding:8px 14px;border-radius:999px}
nav a:hover{background:rgba(255,255,255,.18)}
main{max-width:1080px;margin:24px auto 56px;padding:0 16px}
.table{width:100%;border-collapse:collapse}
.table th,.table td{padding:10px;border-bottom:1px solid #e6e6e6;text-align:left;vertical-align:middle}
.thumb{width:64px;height:64px;object-fit:cover;border-radius:8px;background:#fff}
.qty{display:flex;align-items:center;gap:6px}
.btn{background:var(--azul-btn);color:#fff;border:0;border-radius:8px;padding:8px 12px;text-decoration:none;cursor:pointer;font-weight:bold}
.btn.light{background:#e9eefc;color:#0b2f6b}
.row-actions{display:flex;gap:8px;flex-wrap:wrap}
.total-box{margin-top:16px;display:flex;justify-content:flex-end;gap:12px;align-items:center}
footer{background:var(--azul-footer);color:#fff;text-align:center;padding:22px 16px}
.social img{width:28px;margin:0 8px;vertical-align:middle}
@media(max-width:720px){
  .hide-sm{display:none}
  .table th:nth-child(3), .table td:nth-child(3){display:none}
}
</style>
</head>
<body>
<header>
  <div class="header-wrap">
    <img class="logo" src="https://i.postimg.cc/852rV0T7/Whats-App-Image-2025-03-26-at-12-46-00.jpg" alt="Logo">
    <div class="brand"><h1>ENTRETALLES</h1><p>Carrito</p></div>
  </div>
</header>

<nav>
  <a href="index.html">Inicio</a>
  <a href="digital.html">Digital</a>
  <a href="cart.html" style="position:relative">ðŸ›’ Carrito
    <span id="cart-count" style="display:none; position:absolute; top:-6px; right:-10px; background:#fff; color:#d6006e; border-radius:999px; padding:2px 6px; font-size:12px; font-weight:bold;">0</span>
  </a>
</nav>

<main>
  <div id="empty" style="display:none; text-align:center; padding:24px 0; color:#445;">
    Tu carrito estÃ¡ vacÃ­o.
  </div>

  <table class="table" id="cartTable" style="display:none">
    <thead>
      <tr>
        <th>Producto</th>
        <th class="hide-sm">Imagen</th>
        <th>CategorÃ­a</th>
        <th>Precio</th>
        <th>Cantidad</th>
        <th>Subtotal</th>
        <th></th>
      </tr>
    </thead>
    <tbody id="tbody"></tbody>
  </table>

  <div class="total-box" id="totals" style="display:none">
    <strong id="totalTxt"></strong>
    <button class="btn light" id="clearBtn">Vaciar carrito</button>
    <a class="btn" id="waBtn" target="_blank">Finalizar por WhatsApp</a>
  </div>
</main>

<footer>
  <p>Â© 2025 Entretalles. Todos los derechos reservados.</p>
  <div class="social">
    <a href="https://www.instagram.com/mgconfecciones.arg/" target="_blank"><img src="https://upload.wikimedia.org/wikipedia/commons/a/a5/Instagram_icon.png"></a>
    <a href="https://wa.me/541133627786" target="_blank"><img src="https://upload.wikimedia.org/wikipedia/commons/6/6b/WhatsApp.svg"></a>
    <a href="https://www.facebook.com/share/17EgVid4V9/?mibextid=wwXIfr" target="_blank"><img src="https://upload.wikimedia.org/wikipedia/commons/1/1b/Facebook_icon.svg"></a>
  </div>
</footer>

<!-- carrito comÃºn -->
<script src="cart.js"></script>
<script>
const tbody = document.getElementById('tbody');
const tbl = document.getElementById('cartTable');
const empty = document.getElementById('empty');
const totals = document.getElementById('totals');
const totalTxt = document.getElementById('totalTxt');
const waBtn = document.getElementById('waBtn');
const clearBtn = document.getElementById('clearBtn');

function renderCart(){
  const items = EntretallesCart.all();
  if(!items.length){
    tbl.style.display='none'; totals.style.display='none'; empty.style.display='block';
    EntretallesCart.updateBadge();
    return;
  }
  empty.style.display='none'; tbl.style.display='table'; totals.style.display='flex';
  tbody.innerHTML='';
  items.forEach(it=>{
    const subtotal = (Number(it.precio)||0)*it.qty;
    const tr = document.createElement('tr');
    tr.innerHTML = `
      <td>${it.nombre}</td>
      <td class="hide-sm"><img class="thumb" src="${it.imagen||''}" alt=""></td>
      <td>${it.categoria||''}</td>
      <td>${EntretallesCart.format(it.precio)}</td>
      <td class="qty">
        <button class="btn light" data-act="dec" data-id="${it.id}">-</button>
        <input type="number" value="${it.qty}" min="1" style="width:60px; text-align:center" data-act="set" data-id="${it.id}">
        <button class="btn light" data-act="inc" data-id="${it.id}">+</button>
      </td>
      <td>${EntretallesCart.format(subtotal)}</td>
      <td class="row-actions"><button class="btn light" data-act="del" data-id="${it.id}">Quitar</button></td>
    `;
    tbody.appendChild(tr);
  });
  totalTxt.textContent = 'TOTAL: ' + EntretallesCart.format(EntretallesCart.total());
  waBtn.href = "https://wa.me/541133627786?text=" + EntretallesCart.whatsappText();
  EntretallesCart.updateBadge();
}

// DelegaciÃ³n de eventos
tbody.addEventListener('click', e=>{
  const id = e.target.getAttribute('data-id'); const act = e.target.getAttribute('data-act');
  if(!id || !act) return;
  if(act==='del'){ EntretallesCart.remove(id); renderCart(); }
  if(act==='inc'){ const items=EntretallesCart.all(); const it=items.find(x=>x.id===id); EntretallesCart.setQty(id, (it?.qty||1)+1); renderCart(); }
  if(act==='dec'){ const items=EntretallesCart.all(); const it=items.find(x=>x.id===id); const q=Math.max(1,(it?.qty||1)-1); EntretallesCart.setQty(id,q); renderCart(); }
});
tbody.addEventListener('change', e=>{
  const id = e.target.getAttribute('data-id'); const act = e.target.getAttribute('data-act');
  if(act==='set' && id){ EntretallesCart.setQty(id, e.target.value); renderCart(); }
});
clearBtn.addEventListener('click', ()=>{ if(confirm('Vaciar carrito completo?')){ EntretallesCart.clear(); renderCart(); } });

document.addEventListener('DOMContentLoaded', renderCart);
</script>
</body>
</html>
